<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Logger - Documentación</title>
</head>

<body>

  <h1>Logger</h1>

  <h2>Descripción</h2>
  <p>
    La clase <strong>Logger</strong> se encarga del registro y gestión de logs del sistema.
    Permite almacenar mensajes informativos, advertencias, errores y mensajes de depuración
    en archivos de texto organizados por fecha.
  </p>
  <p>
    Soporta distintos niveles de log, contexto adicional en formato estructurado y
    detección automática del entorno de ejecución (web o CLI).
  </p>
  <p>
    Cada registro se almacena en un archivo diario (<em>YYYY-MM-DD.log</em>) dentro
    del directorio configurado.
  </p>

  <h2>Ejemplos de uso</h2>

  <h3>1. Crear instancia del logger</h3>
  <pre>
$logger = new Logger(__DIR__ . '/logs');
  </pre>

  <h3>2. Registrar un mensaje informativo (INFO)</h3>
  <pre>
$logger
  ->message('Aplicación iniciada')
  ->write();
  </pre>

  <h3>3. Registrar un mensaje con tipo específico</h3>
  <pre>
$logger
  ->message('Usuario autenticado correctamente')
  ->type('SUCCESS')
  ->write();
  </pre>

  <h3>4. Registrar una advertencia (WARNING)</h3>
  <pre>
$logger
  ->message('Intento de acceso no autorizado')
  ->type('WARNING')
  ->write();
  </pre>

  <h3>5. Registrar un error (ERROR)</h3>
  <pre>
$logger
  ->message('No se pudo conectar a la base de datos')
  ->type('ERROR')
  ->write();
  </pre>

  <h3>6. Registrar información de depuración (DEBUG)</h3>
  <pre>
$logger
  ->message('Resultado de la consulta SQL')
  ->type('DEBUG')
  ->write();
  </pre>

  <h3>7. Registrar un mensaje con contexto adicional</h3>
  <pre>
$logger
  ->message('Creación de usuario')
  ->type('INFO')
  ->with('user_id', 15)
  ->with('email', 'usuario@example.com')
  ->write();
  </pre>

  <h3>8. Registrar múltiples valores de contexto</h3>
  <pre>
$logger
  ->message('Proceso de pago')
  ->type('SUCCESS')
  ->with('order_id', 1024)
  ->with('amount', 59.99)
  ->with('currency', 'USD')
  ->write();
  </pre>

  <h3>9. Registrar una excepción</h3>
  <pre>
try {
  throw new Exception('Error de prueba');
} catch (Throwable $e) {
  $logger
    ->message('Excepción capturada')
    ->type('ERROR')
    ->with('exception', $e)
    ->write();
}
  </pre>

  <h3>10. Uso en scripts CLI</h3>
  <pre>
$logger
  ->message('Script ejecutado desde consola')
  ->type('INFO')
  ->write();
  </pre>

  <h3>11. Flujo completo recomendado</h3>
  <pre>
$logger
  ->message('Actualización de perfil')
  ->type('SUCCESS')
  ->with('user_id', 20)
  ->with('ip', $_SERVER['REMOTE_ADDR'] ?? 'CLI')
  ->write();
  </pre>

  <h2>Formato del archivo de log</h2>
  <p>
    Cada línea del archivo de log tiene el siguiente formato:
  </p>

  <pre>
[YYYY-MM-DD HH:MM:SS] [TYPE] [IP] [ROUTE] Mensaje {contexto}
  </pre>

  <h2>Niveles de log soportados</h2>
  <ul>
    <li>ERROR</li>
    <li>SUCCESS</li>
    <li>WARNING</li>
    <li>INFO</li>
    <li>DEBUG</li>
  </ul>

  <h2>Comportamiento interno</h2>
  <ul>
    <li>El directorio de logs se crea automáticamente si no existe</li>
    <li>El contexto se normaliza para evitar errores de serialización</li>
    <li>Las excepciones se almacenan como estructura de datos legible</li>
    <li>Después de escribir un log, el estado interno se reinicia</li>
  </ul>

</body>

</html>