<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Logger - Documentación</title>
</head>

<body>

  <h1>Logger</h1>

  <h2>Descripción</h2>
  <p>
    La clase <strong>Logger</strong> proporciona un sistema de logging estructurado
    con niveles explícitos y soporte para subcarpetas automáticas por dominio.
  </p>
  <p>
    Permite registrar eventos del sistema en archivos diarios, organizados
    opcionalmente por contexto o módulo (scope), facilitando la depuración,
    auditoría y monitoreo de la aplicación.
  </p>
  <p>
    Cada entrada de log incluye fecha y hora, nivel, IP, ruta actual y
    contexto adicional en formato estructurado.
  </p>

  <h2>Ejemplos de uso</h2>

  <h3>1. Crear instancia del logger</h3>
  <pre>
$logger = new Logger(__DIR__ . '/logs');
  </pre>

  <h3>2. Registrar mensaje informativo (INFO)</h3>
  <pre>
$logger
  ->info('Aplicación iniciada')
  ->write();
  </pre>

  <h3>3. Registrar advertencia (WARNING)</h3>
  <pre>
$logger
  ->warning('Configuración incompleta')
  ->write();
  </pre>

  <h3>4. Registrar error (ERROR)</h3>
  <pre>
$logger
  ->error('Error al conectar con la base de datos')
  ->write();
  </pre>

  <h3>5. Registrar mensaje de depuración (DEBUG)</h3>
  <pre>
$logger
  ->debug('Consulta SQL ejecutada')
  ->write();
  </pre>

  <h3>6. Registrar log con contexto adicional</h3>
  <pre>
$logger
  ->info('Usuario autenticado')
  ->with('user_id', 15)
  ->with('email', 'usuario@correo.com')
  ->write();
  </pre>

  <h3>7. Registrar una excepción</h3>
  <pre>
try {
  throw new Exception('Error de prueba');
} catch (Throwable $e) {
  $logger
    ->error('Excepción capturada')
    ->with('exception', $e)
    ->write();
}
  </pre>

  <h3>8. Uso de subcarpeta por dominio (scope)</h3>
  <pre>
$logger
  ->file('mail')
  ->info('Correo enviado correctamente')
  ->write();
  </pre>

  <h3>9. Subcarpeta con error específico</h3>
  <pre>
$logger
  ->file('database')
  ->error('Fallo en la consulta')
  ->with('query', 'SELECT * FROM users')
  ->write();
  </pre>

  <h3>10. Logs organizados por módulo</h3>
  <pre>
$logger
  ->file('auth')
  ->warning('Intento de acceso fallido')
  ->with('ip', $_SERVER['REMOTE_ADDR'])
  ->write();
  </pre>

  <h3>11. Uso en scripts CLI</h3>
  <pre>
$logger
  ->file('cli')
  ->info('Script ejecutado desde consola')
  ->write();
  </pre>

  <h3>12. Flujo completo recomendado</h3>
  <pre>
$logger = new Logger(__DIR__ . '/logs');

$logger
  ->file('users')
  ->info('Perfil actualizado')
  ->with('user_id', 20)
  ->write();

$logger
  ->file('security')
  ->warning('Intento sospechoso')
  ->with('ip', $_SERVER['REMOTE_ADDR'])
  ->write();
  </pre>

  <h2>Estructura de archivos generada</h2>
  <pre>
logs/
├── users/
│   └── 2026-01-08.log
├── security/
│   └── 2026-01-08.log
├── mail/
│   └── 2026-01-08.log
└── 2026-01-08.log
  </pre>

  <h2>Formato del log</h2>
  <pre>
[YYYY-MM-DD HH:MM:SS] [LEVEL] [IP] [ROUTE] Mensaje {contexto}
  </pre>

  <h2>Niveles soportados</h2>
  <ul>
    <li>INFO</li>
    <li>WARNING</li>
    <li>ERROR</li>
    <li>DEBUG</li>
  </ul>

  <h2>Notas de funcionamiento</h2>
  <ul>
    <li>Los logs se almacenan en archivos diarios por fecha</li>
    <li>El dominio (scope) crea subcarpetas automáticamente</li>
    <li>El contexto se serializa en JSON</li>
    <li>Las excepciones se normalizan automáticamente</li>
    <li>El estado interno se reinicia después de cada escritura</li>
  </ul>

</body>

</html>